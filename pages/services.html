
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—Å–ª—É–≥–∏ –∏ –∑–∞–ø—á–∞—Å—Ç–∏ - –ß–ò–ü: –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã–º —Ü–µ–Ω—Ç—Ä–æ–º</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/responsive.css">
    <style>
        .services-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-xl);
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }
        
        .services-tabs {
            display: flex;
            border-bottom: 1px solid var(--color-border);
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
        }
        
        .service-tab {
            padding: var(--spacing-md) var(--spacing-lg);
            background: none;
            border: none;
            font-family: var(--font-family);
            font-size: var(--font-size-base);
            font-weight: 500;
            color: var(--color-text-light);
            cursor: pointer;
            position: relative;
            transition: all var(--transition-fast);
            white-space: nowrap;
        }
        
        .service-tab:hover {
            color: var(--color-text);
        }
        
        .service-tab.active {
            color: var(--color-primary);
        }
        
        .service-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--color-primary);
        }
        
        .service-tab-badge {
            margin-left: var(--spacing-xs);
            background-color: var(--color-bg);
            color: var(--color-text-light);
            padding: 2px 6px;
            border-radius: 10px;
            font-size: var(--font-size-xs);
        }
        
        .services-content {
            display: none;
        }
        
        .services-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }
        
        .service-card {
            background-color: var(--color-bg-card);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-md);
            transition: all var(--transition-fast);
            border: 1px solid var(--color-border);
            position: relative;
        }
        
        .service-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--color-primary-light);
        }
        
        .service-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-md);
        }
        
        .service-card-category {
            font-size: var(--font-size-sm);
            color: var(--color-text-light);
            margin-bottom: var(--spacing-xs);
        }
        
        .service-card-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: var(--spacing-sm);
        }
        
        .service-card-description {
            font-size: var(--font-size-sm);
            color: var(--color-text-light);
            margin-bottom: var(--spacing-md);
            line-height: var(--line-height-relaxed);
        }
        
        .service-card-price {
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: var(--spacing-md);
        }
        
        .service-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: var(--spacing-md);
            border-top: 1px solid var(--color-border);
        }
        
        .service-card-stock {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            font-size: var(--font-size-sm);
        }
        
        .stock-badge {
            padding: 4px 8px;
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            font-weight: 500;
        }
        
        .stock-high {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--color-success);
        }
        
        .stock-medium {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--color-warning);
        }
        
        .stock-low {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--color-danger);
        }
        
        .stock-out {
            background-color: rgba(107, 114, 128, 0.1);
            color: var(--color-info);
        }
        
        .service-actions {
            display: flex;
            gap: var(--spacing-xs);
        }
        
        .service-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xl);
            margin-bottom: var(--spacing-md);
        }
        
        .service-icon.diagnostic {
            background-color: rgba(59, 130, 246, 0.1);
            color: var(--color-primary-light);
        }
        
        .service-icon.repair {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--color-success);
        }
        
        .service-icon.software {
            background-color: rgba(139, 92, 246, 0.1);
            color: #8B5CF6;
        }
        
        .service-icon.cleaning {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--color-warning);
        }
        
        .service-icon.parts {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--color-danger);
        }
        
        .category-filter {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
        }
        
        .category-btn {
            padding: var(--spacing-sm) var(--spacing-md);
            background-color: var(--color-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            font-family: var(--font-family);
            font-size: var(--font-size-sm);
            color: var(--color-text-light);
            cursor: pointer;
            transition: all var(--transition-fast);
            white-space: nowrap;
        }
        
        .category-btn:hover {
            background-color: var(--color-bg-hover);
            color: var(--color-text);
        }
        
        .category-btn.active {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }
        
        .price-range {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }
        
        .price-input {
            width: 120px;
        }
        
        .price-slider {
            flex: 1;
            height: 6px;
            background-color: var(--color-border);
            border-radius: var(--radius-full);
            position: relative;
        }
        
        .price-slider-track {
            position: absolute;
            height: 100%;
            background-color: var(--color-primary);
            border-radius: var(--radius-full);
        }
        
        .price-slider-thumb {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: white;
            border: 2px solid var(--color-primary);
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
        }
        
        .stock-alert {
            background-color: rgba(239, 68, 68, 0.05);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }
        
        .stock-alert-icon {
            color: var(--color-danger);
            font-size: var(--font-size-xl);
        }
        
        .stock-alert-content {
            flex: 1;
        }
        
        .stock-alert-title {
            font-weight: 600;
            color: var(--color-danger);
            margin-bottom: var(--spacing-xs);
        }
        
        .stock-alert-text {
            font-size: var(--font-size-sm);
            color: var(--color-text-light);
        }
        
        .empty-catalog {
            text-align: center;
            padding: var(--spacing-2xl) var(--spacing-lg);
            color: var(--color-text-light);
        }
        
        .empty-catalog-icon {
            font-size: 48px;
            margin-bottom: var(--spacing-lg);
            opacity: 0.5;
        }
        
        .empty-catalog-title {
            font-size: var(--font-size-xl);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--color-text);
        }
        
        .search-sort {
            display: flex;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
        }
        
        .search-box {
            flex: 1;
            min-width: 250px;
        }
        
        .sort-select {
            width: 200px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .price-history {
            margin-top: var(--spacing-md);
            font-size: var(--font-size-sm);
            color: var(--color-text-light);
        }
        
        .price-change {
            display: inline-flex;
            align-items: center;
            margin-left: var(--spacing-xs);
        }
        
        .price-change.up {
            color: var(--color-success);
        }
        
        .price-change.down {
            color: var(--color-danger);
        }
        
        .supplier-info {
            font-size: var(--font-size-xs);
            color: var(--color-text-lighter);
            margin-top: var(--spacing-xs);
        }
        
        .warranty-badge {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--color-success);
            padding: 2px 6px;
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            font-weight: 500;
            margin-left: var(--spacing-xs);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">–ß</div>
                <div>
                    <div class="logo-text">–ß–ò–ü: ServiceTrack</div>
                    <div class="logo-subtext">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–º —Ü–µ–Ω—Ç—Ä–æ–º</div>
                </div>
            </div>
            
            <nav class="nav-menu">
                <a href="../index.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>–î–∞—à–±–æ—Ä–¥</span>
                </a>
                <a href="orders.html" class="nav-item">
                    <i class="fas fa-clipboard-list"></i>
                    <span>–ó–∞—è–≤–∫–∏</span>
                </a>
                <a href="clients.html" class="nav-item">
                    <i class="fas fa-users"></i>
                    <span>–ö–ª–∏–µ–Ω—Ç—ã</span>
                </a>
                <a href="employees.html" class="nav-item">
                    <i class="fas fa-user-cog"></i>
                    <span>–ú–∞—Å—Ç–µ—Ä–∞</span>
                </a>
                <a href="services.html" class="nav-item active" data-permission="services.view">
                    <i class="fas fa-cogs"></i>
                    <span>–£—Å–ª—É–≥–∏ –∏ –∑–∞–ø—á–∞—Å—Ç–∏</span>
                </a>
                <a href="reports.html" class="nav-item" data-permission="reports.view">
                    <i class="fas fa-chart-bar"></i>
                    <span>–û—Ç—á—ë—Ç—ã</span>
                </a>
                <a href="settings.html" class="nav-item" data-permission="settings.view">
                    <i class="fas fa-cog"></i>
                    <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-avatar">–ò–ü</div>
                <div class="user-info">
                    <div class="user-name">–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤</div>
                    <div class="user-role">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                </div>
                <a href="#" class="action-btn" data-action="logout" title="–í—ã–π—Ç–∏">
                    <i class="fas fa-sign-out-alt"></i>
                </a>
            </div>
        </aside>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
        <main class="main-content">
            <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
            <header class="topbar">
                <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                    <button class="mobile-menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">–£—Å–ª—É–≥–∏ –∏ –∑–∞–ø—á–∞—Å—Ç–∏</h1>
                </div>
                
                <div class="topbar-actions">
                    <button class="btn btn-primary" id="addServiceBtn">
                        <i class="fas fa-plus"></i>
                        <span>–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</span>
                    </button>
                    <button class="btn btn-secondary" id="addPartBtn">
                        <i class="fas fa-microchip"></i>
                        <span>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø—á–∞—Å—Ç—å</span>
                    </button>
                </div>
            </header>
            
            <!-- –¢–∞–±—ã —É—Å–ª—É–≥ –∏ –∑–∞–ø—á–∞—Å—Ç–µ–π -->
            <div class="services-tabs">
                <button class="service-tab active" data-tab="services">
                    <i class="fas fa-tools"></i>
                    –£—Å–ª—É–≥–∏
                    <span class="service-tab-badge" id="servicesCount">24</span>
                </button>
                <button class="service-tab" data-tab="parts">
                    <i class="fas fa-microchip"></i>
                    –ó–∞–ø—á–∞—Å—Ç–∏
                    <span class="service-tab-badge" id="partsCount">45</span>
                </button>
                <button class="service-tab" data-tab="categories">
                    <i class="fas fa-folder"></i>
                    –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
                    <span class="service-tab-badge" id="categoriesCount">8</span>
                </button>
                <button class="service-tab" data-tab="suppliers">
                    <i class="fas fa-truck"></i>
                    –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏
                    <span class="service-tab-badge" id="suppliersCount">12</span>
                </button>
                <button class="service-tab" data-tab="priceList">
                    <i class="fas fa-file-invoice-dollar"></i>
                    –ü—Ä–∞–π—Å-–ª–∏—Å—Ç
                </button>
            </div>
            
            <!-- –ü–æ–∏—Å–∫ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
            <div class="search-sort">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="servicesSearch" placeholder="–ü–æ–∏—Å–∫ —É—Å–ª—É–≥ –∏ –∑–∞–ø—á–∞—Å—Ç–µ–π...">
                </div>
                
                <select class="form-control sort-select" id="sortBy">
                    <option value="name_asc">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–ê-–Ø)</option>
                    <option value="name_desc">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–Ø-–ê)</option>
                    <option value="price_asc">–ü–æ —Ü–µ–Ω–µ (–¥–µ—à–µ–≤—ã–µ)</option>
                    <option value="price_desc">–ü–æ —Ü–µ–Ω–µ (–¥–æ—Ä–æ–≥–∏–µ)</option>
                    <option value="popularity">–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏</option>
                    <option value="stock">–ü–æ –æ—Å—Ç–∞—Ç–∫–∞–º</option>
                </select>
                
                <button class="btn btn-secondary" id="resetFiltersBtn">
                    <i class="fas fa-redo"></i>
                    –°–±—Ä–æ—Å–∏—Ç—å
                </button>
            </div>
            
            <!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
            <div class="category-filter" id="categoriesFilter">
                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–∏–∑–∫–∏—Ö –æ—Å—Ç–∞—Ç–∫–∞—Ö -->
            <div class="stock-alert d-none" id="lowStockAlert">
                <div class="stock-alert-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="stock-alert-content">
                    <div class="stock-alert-title">–ù–∏–∑–∫–∏–µ –æ—Å—Ç–∞—Ç–∫–∏ –∑–∞–ø—á–∞—Å—Ç–µ–π</div>
                    <div class="stock-alert-text" id="lowStockItems">
                        <!-- –°–ø–∏—Å–æ–∫ –∑–∞–ø—á–∞—Å—Ç–µ–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>
                <button class="btn btn-sm btn-danger" id="orderStockBtn">
                    –ó–∞–∫–∞–∑–∞—Ç—å
                </button>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç: –£—Å–ª—É–≥–∏ -->
            <div class="services-content active" id="servicesTab">
                <div class="services-grid" id="servicesGrid">
                    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —É—Å–ª—É–≥ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                
                <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
                <div class="empty-catalog d-none" id="emptyServices">
                    <div class="empty-catalog-icon">
                        <i class="fas fa-tools"></i>
                    </div>
                    <h3 class="empty-catalog-title">–£—Å–ª—É–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                    <p class="mb-4">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —É—Å–ª—É–≥—É –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
                    <button class="btn btn-primary" id="addFirstServiceBtn">
                        <i class="fas fa-plus"></i>
                        –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É
                    </button>
                </div>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç: –ó–∞–ø—á–∞—Å—Ç–∏ -->
            <div class="services-content" id="partsTab">
                <div class="services-grid" id="partsGrid">
                    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–ø—á–∞—Å—Ç–µ–π –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                
                <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
                <div class="empty-catalog d-none" id="emptyParts">
                    <div class="empty-catalog-icon">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <h3 class="empty-catalog-title">–ó–∞–ø—á–∞—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                    <p class="mb-4">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–ø—á–∞—Å—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
                    <button class="btn btn-primary" id="addFirstPartBtn">
                        <i class="fas fa-plus"></i>
                        –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø—á–∞—Å—Ç—å
                    </button>
                </div>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
            <div class="services-content" id="categoriesTab">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥ –∏ –∑–∞–ø—á–∞—Å—Ç–µ–π</h3>
                        <button class="btn btn-primary btn-sm" id="addCategoryBtn">
                            <i class="fas fa-plus"></i>
                            –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="categoriesTable">
                                <thead>
                                    <tr>
                                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                        <th>–¢–∏–ø</th>
                                        <th>–£—Å–ª—É–≥/–∑–∞–ø—á–∞—Å—Ç–µ–π</th>
                                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="categoriesTableBody">
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç: –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ -->
            <div class="services-content" id="suppliersTab">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ –∑–∞–ø—á–∞—Å—Ç–µ–π</h3>
                        <button class="btn btn-primary btn-sm" id="addSupplierBtn">
                            <i class="fas fa-plus"></i>
                            –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="suppliersTable">
                                <thead>
                                    <tr>
                                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                        <th>–ö–æ–Ω—Ç–∞–∫—Ç—ã</th>
                                        <th>–¢–∏–ø—ã –∑–∞–ø—á–∞—Å—Ç–µ–π</th>
                                        <th>–°—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏</th>
                                        <th>–†–µ–π—Ç–∏–Ω–≥</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="suppliersTableBody">
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç: –ü—Ä–∞–π—Å-–ª–∏—Å—Ç -->
            <div class="services-content" id="priceListTab">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–ü—Ä–∞–π—Å-–ª–∏—Å—Ç —É—Å–ª—É–≥ –∏ –∑–∞–ø—á–∞—Å—Ç–µ–π</h3>
                        <div>
                            <button class="btn btn-secondary btn-sm" id="printPriceListBtn">
                                <i class="fas fa-print"></i>
                                –ü–µ—á–∞—Ç—å
                            </button>
                            <button class="btn btn-success btn-sm" id="exportPriceListBtn">
                                <i class="fas fa-download"></i>
                                –≠–∫—Å–ø–æ—Ä—Ç
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="priceListTable">
                                <thead>
                                    <tr>
                                        <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                                        <th>–¢–∏–ø</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–ö–æ–¥</th>
                                        <th>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</th>
                                        <th>–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</th>
                                        <th>–ù–∞—Ü–µ–Ω–∫–∞</th>
                                        <th>–û—Å—Ç–∞—Ç–æ–∫</th>
                                    </tr>
                                </thead>
                                <tbody id="priceListTableBody">
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É—Å–ª—É–≥–∏ -->
    <div class="modal" id="addServiceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏</h3>
                <button class="modal-close" data-modal="addServiceModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addServiceForm">
                    <div class="form-group">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" name="name" required 
                               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–æ—É—Ç–±—É–∫–∞">
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                <select class="form-control" name="categoryId" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–¢–∏–ø —É—Å–ª—É–≥–∏</label>
                                <select class="form-control" name="type" required>
                                    <option value="diagnostic">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</option>
                                    <option value="repair">–†–µ–º–æ–Ω—Ç</option>
                                    <option value="software">–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ</option>
                                    <option value="cleaning">–ß–∏—Å—Ç–∫–∞</option>
                                    <option value="preventive">–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞</option>
                                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" name="description" rows="3" 
                                  placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏..."></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–°—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" name="price" required 
                                       min="0" step="100" placeholder="0">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—á–∞—Å—ã)</label>
                                <input type="number" class="form-control" name="duration" 
                                       min="0.5" max="24" step="0.5" value="1">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ì–∞—Ä–∞–Ω—Ç–∏—è (–º–µ—Å—è—Ü—ã)</label>
                        <input type="number" class="form-control" name="warranty" 
                               min="0" max="36" value="3">
                    </div>
                    
                    <div class="form-group">
                        <label class="checkbox">
                            <input type="checkbox" name="isActive" checked>
                            <span class="checkbox-text">–£—Å–ª—É–≥–∞ –∞–∫—Ç–∏–≤–Ω–∞</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-modal="addServiceModal">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" form="addServiceForm" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—á–∞—Å—Ç–∏ -->
    <div class="modal" id="addPartModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏</h3>
                <button class="modal-close" data-modal="addPartModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addPartForm">
                    <div class="form-group">
                        <label class="form-label">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" name="name" required 
                               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å DDR4 8GB">
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–ê—Ä—Ç–∏–∫—É–ª/–ö–æ–¥</label>
                                <input type="text" class="form-control" name="code" 
                                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: RAM-8G-D4">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                <select class="form-control" name="categoryId" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" name="description" rows="2" 
                                  placeholder="–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å..."></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="form-label">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" name="costPrice" required 
                                       min="0" step="100" placeholder="0">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="form-label">–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (‚ÇΩ) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" name="sellPrice" required 
                                       min="0" step="100" placeholder="0">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="form-label">–ù–∞—Ü–µ–Ω–∫–∞</label>
                                <input type="text" class="form-control" name="margin" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ</label>
                                <input type="number" class="form-control" name="stock" 
                                       min="0" value="0">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø–∞—Å</label>
                                <input type="number" class="form-control" name="minStock" 
                                       min="0" value="5">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ü–æ—Å—Ç–∞–≤—â–∏–∫</label>
                        <select class="form-control" name="supplierId">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</option>
                            <!-- –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ì–∞—Ä–∞–Ω—Ç–∏—è (–º–µ—Å—è—Ü—ã)</label>
                        <input type="number" class="form-control" name="warranty" 
                               min="0" max="36" value="12">
                    </div>
                    
                    <div class="form-group">
                        <label class="checkbox">
                            <input type="checkbox" name="isActive" checked>
                            <span class="checkbox-text">–ó–∞–ø—á–∞—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-modal="addPartModal">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" form="addPartForm" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø—á–∞—Å—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
    <div class="modal" id="addCategoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
                <button class="modal-close" data-modal="addCategoryModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addCategoryForm">
                    <div class="form-group">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" name="name" required 
                               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –¥–ª—è –ü–ö">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–¢–∏–ø</label>
                        <select class="form-control" name="type" required>
                            <option value="service">–î–ª—è —É—Å–ª—É–≥</option>
                            <option value="part">–î–ª—è –∑–∞–ø—á–∞—Å—Ç–µ–π</option>
                            <option value="both">–î–ª—è —É—Å–ª—É–≥ –∏ –∑–∞–ø—á–∞—Å—Ç–µ–π</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" name="description" rows="3" 
                                  placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select class="form-control" name="parentId">
                            <option value="">–ù–µ—Ç (–∫–æ—Ä–Ω–µ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è)</option>
                            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ò–∫–æ–Ω–∫–∞</label>
                        <div class="d-flex align-items-center">
                            <select class="form-control" name="icon" style="width: 200px;">
                                <option value="tools">üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</option>
                                <option value="microchip">üíª –ú–∏–∫—Ä–æ—Å—Ö–µ–º–∞</option>
                                <option value="desktop">üñ•Ô∏è –ö–æ–º–ø—å—é—Ç–µ—Ä</option>
                                <option value="laptop">üíª –ù–æ—É—Ç–±—É–∫</option>
                                <option value="printer">üñ®Ô∏è –ü—Ä–∏–Ω—Ç–µ—Ä</option>
                                <option value="mobile">üì± –¢–µ–ª–µ—Ñ–æ–Ω</option>
                                <option value="cog">‚öôÔ∏è –®–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞</option>
                                <option value="wrench">üîß –ì–∞–µ—á–Ω—ã–π –∫–ª—é—á</option>
                            </select>
                            <div class="ml-2" id="iconPreview" style="font-size: 24px;">üõ†Ô∏è</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–¶–≤–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
                        <input type="color" class="form-control" name="color" value="#1E40AF" 
                               style="width: 60px; height: 40px;">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-modal="addCategoryModal">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" form="addCategoryForm" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ -->
    <div class="modal" id="addSupplierModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</h3>
                <button class="modal-close" data-modal="addSupplierModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addSupplierForm">
                    <div class="form-group">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" name="name" required 
                               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–û–û '–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ'">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ</label>
                        <input type="text" class="form-control" name="contactPerson" 
                               placeholder="–§–ò–û –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–≥–æ –ª–∏—Ü–∞">
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                <input type="tel" class="form-control" name="phone" 
                                       placeholder="+7 (999) 123-45-67">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" name="email" 
                                       placeholder="info@example.com">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ê–¥—Ä–µ—Å</label>
                        <textarea class="form-control" name="address" rows="2" 
                                  placeholder="–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–°–∞–π—Ç</label>
                        <input type="url" class="form-control" name="website" 
                               placeholder="https://example.com">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–¢–∏–ø—ã –∑–∞–ø—á–∞—Å—Ç–µ–π</label>
                        <textarea class="form-control" name="partTypes" rows="2" 
                                  placeholder="–ö–∞–∫–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)"></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏ (–¥–Ω–µ–π)</label>
                                <input type="number" class="form-control" name="deliveryDays" 
                                       min="1" max="30" value="3">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ (‚ÇΩ)</label>
                                <input type="number" class="form-control" name="minOrder" 
                                       min="0" step="1000" value="10000">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–†–µ–π—Ç–∏–Ω–≥</label>
                        <div class="d-flex align-items-center">
                            <div class="rating-stars">
                                <i class="fas fa-star" data-rating="1"></i>
                                <i class="fas fa-star" data-rating="2"></i>
                                <i class="fas fa-star" data-rating="3"></i>
                                <i class="fas fa-star" data-rating="4"></i>
                                <i class="fas fa-star" data-rating="5"></i>
                            </div>
                            <input type="hidden" name="rating" value="3">
                            <span class="ml-2" id="ratingValue">3/5</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</label>
                        <textarea class="form-control" name="comments" rows="2" 
                                  placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–µ"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-modal="addSupplierModal">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" form="addSupplierForm" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</button>
            </div>
        </div>
    </div>

    <script src="../js/main.js"></script>
    
    <script>
        // –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å–ª—É–≥–∞–º–∏ –∏ –∑–∞–ø—á–∞—Å—Ç—è–º–∏
        class ServicesSystem {
            constructor() {
                this.services = this.loadServices();
                this.parts = this.loadParts();
                this.categories = this.loadCategories();
                this.suppliers = this.loadSuppliers();
                this.storageKey = 'chip_service_catalog';
            }
            
            loadServices() {
                const saved = localStorage.getItem(`${this.storageKey}_services`);
                if (saved) return JSON.parse(saved);
                
                // –î–µ–º–æ-—É—Å–ª—É–≥–∏
                const demoServices = [
                    {
                        id: 1,
                        name: "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–æ—É—Ç–±—É–∫–∞",
                        description: "–ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–æ—É—Ç–±—É–∫–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π",
                        categoryId: 1,
                        categoryName: "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
                        type: "diagnostic",
                        price: 500,
                        duration: 1,
                        warranty: 3,
                        isActive: true,
                        popularity: 45,
                        createdAt: "2025-01-15"
                    },
                    {
                        id: 2,
                        name: "–ß–∏—Å—Ç–∫–∞ –æ—Ç –ø—ã–ª–∏ –∏ –∑–∞–º–µ–Ω–∞ —Ç–µ—Ä–º–æ–ø–∞—Å—Ç—ã",
                        description: "–ü–æ–ª–Ω–∞—è —á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è, –∑–∞–º–µ–Ω–∞ —Ç–µ—Ä–º–æ–ø–∞—Å—Ç—ã",
                        categoryId: 2,
                        categoryName: "–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ",
                        type: "cleaning",
                        price: 1200,
                        duration: 2,
                        warranty: 6,
                        isActive: true,
                        popularity: 32,
                        createdAt: "2025-01-15"
                    },
                    {
                        id: 3,
                        name: "–ó–∞–º–µ–Ω–∞ –º–∞—Ç—Ä–∏—Ü—ã –Ω–æ—É—Ç–±—É–∫–∞",
                        description: "–ó–∞–º–µ–Ω–∞ —ç–∫—Ä–∞–Ω–∞ –Ω–æ—É—Ç–±—É–∫–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É",
                        categoryId: 3,
                        categoryName: "–†–µ–º–æ–Ω—Ç",
                        type: "repair",
                        price: 4500,
                        duration: 3,
                        warranty: 12,
                        isActive: true,
                        popularity: 18,
                        createdAt: "2025-01-15"
                    },
                    {
                        id: 4,
                        name: "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Windows + –¥—Ä–∞–π–≤–µ—Ä—ã",
                        description: "–ß–∏—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Windows, –≤—Å–µ—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ü–û",
                        categoryId: 4,
                        categoryName: "–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ",
                        type: "software",
                        price: 1500,
                        duration: 2,
                        warranty: 3,
                        isActive: true,
                        popularity: 28,
                        createdAt: "2025-01-15"
                    }
                ];
                
                this.saveServices(demoServices);
                return demoServices;
            }
            
            loadParts() {
                const saved = localStorage.getItem(`${this.storageKey}_parts`);
                if (saved) return JSON.parse(saved);
                
                // –î–µ–º–æ-–∑–∞–ø—á–∞—Å—Ç–∏
                const demoParts = [
                    {
                        id: 1,
                        name: "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å DDR4 8GB",
                        code: "RAM-8G-D4",
                        description: "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å DDR4, 8GB, 2666MHz",
                        categoryId: 5,
                        categoryName: "–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –ü–ö",
                        costPrice: 1800,
                        sellPrice: 2500,
                        stock: 12,
                        minStock: 5,
                        supplierId: 1,
                        supplierName: "–û–û–û '–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –ü–ª—é—Å'",
                        warranty: 24,
                        isActive: true,
                        popularity: 65,
                        lastOrdered: "2025-12-20"
                    },
                    {
                        id: 2,
                        name: "SSD –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å 240GB",
                        code: "SSD-240-SATA",
                        description: "SSD –¥–∏—Å–∫, 240GB, SATA III",
                        categoryId: 5,
                        categoryName: "–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –ü–ö",
                        costPrice: 1200,
                        sellPrice: 1800,
                        stock: 8,
                        minStock: 3,
                        supplierId: 2,
                        supplierName: "–¢–î '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞'",
                        warranty: 36,
                        isActive: true,
                        popularity: 42,
                        lastOrdered: "2025-12-18"
                    },
                    {
                        id: 3,
                        name: "–ö–∞—Ä—Ç—Ä–∏–¥–∂ –¥–ª—è HP LaserJet 107A",
                        code: "HP-107A-CART",
                        description: "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–∞—Ä—Ç—Ä–∏–¥–∂ –¥–ª—è HP LaserJet Pro M107a",
                        categoryId: 6,
                        categoryName: "–†–∞—Å—Ö–æ–¥–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",
                        costPrice: 800,
                        sellPrice: 1200,
                        stock: 15,
                        minStock: 10,
                        supplierId: 3,
                        supplierName: "–û–û–û '–ü—Ä–∏–Ω—Ç–°–µ—Ä–≤–∏—Å'",
                        warranty: 12,
                        isActive: true,
                        popularity: 38,
                        lastOrdered: "2025-12-22"
                    },
                    {
                        id: 4,
                        name: "–ú–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –Ω–æ—É—Ç–±—É–∫–∞ 15.6\" Full HD",
                        code: "LCD-156-FHD",
                        description: "–ú–∞—Ç—Ä–∏—Ü–∞ 15.6 –¥—é–π–º–æ–≤, Full HD, –º–∞—Ç–æ–≤–∞—è",
                        categoryId: 7,
                        categoryName: "–≠–∫—Ä–∞–Ω—ã –∏ –º–∞—Ç—Ä–∏—Ü—ã",
                        costPrice: 3200,
                        sellPrice: 4500,
                        stock: 3,
                        minStock: 2,
                        supplierId: 1,
                        supplierName: "–û–û–û '–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –ü–ª—é—Å'",
                        warranty: 12,
                        isActive: true,
                        popularity: 24,
                        lastOrdered: "2025-12-15"
                    }
                ];
                
                this.saveParts(demoParts);
                return demoParts;
            }
            
            loadCategories() {
                const saved = localStorage.getItem(`${this.storageKey}_categories`);
                if (saved) return JSON.parse(saved);
                
                // –î–µ–º–æ-–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                const demoCategories = [
                    { id: 1, name: "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞", type: "service", description: "–£—Å–ª—É–≥–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏", parentId: null, color: "#3B82F6", icon: "search" },
                    { id: 2, name: "–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ", type: "service", description: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ", parentId: null, color: "#10B981", icon: "tools" },
                    { id: 3, name: "–†–µ–º–æ–Ω—Ç", type: "service", description: "–†–µ–º–æ–Ω—Ç–Ω—ã–µ —Ä–∞–±–æ—Ç—ã", parentId: null, color: "#EF4444", icon: "wrench" },
                    { id: 4, name: "–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ", type: "service", description: "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ü–û", parentId: null, color: "#8B5CF6", icon: "desktop" },
                    { id: 5, name: "–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –ü–ö", type: "part", description: "–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤", parentId: null, color: "#F59E0B", icon: "microchip" },
                    { id: 6, name: "–†–∞—Å—Ö–æ–¥–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã", type: "part", description: "–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏ –¥–ª—è –æ—Ä–≥—Ç–µ—Ö–Ω–∏–∫–∏", parentId: null, color: "#6B7280", icon: "printer" },
                    { id: 7, name: "–≠–∫—Ä–∞–Ω—ã –∏ –º–∞—Ç—Ä–∏—Ü—ã", type: "part", description: "–î–∏—Å–ø–ª–µ–∏ –¥–ª—è –Ω–æ—É—Ç–±—É–∫–æ–≤ –∏ –º–æ–Ω–∏—Ç–æ—Ä–æ–≤", parentId: null, color: "#EC4899", icon: "mobile" }
                ];
                
                this.saveCategories(demoCategories);
                return demoCategories;
            }
            
            loadSuppliers() {
                const saved = localStorage.getItem(`${this.storageKey}_suppliers`);
                if (saved) return JSON.parse(saved);
                
                // –î–µ–º–æ-–ø–æ—Å—Ç–∞–≤—â–∏–∫–∏
                const demoSuppliers = [
                    {
                        id: 1,
                        name: "–û–û–û '–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –ü–ª—é—Å'",
                        contactPerson: "–ò–≤–∞–Ω–æ–≤ –ü–µ—Ç—Ä –°–µ—Ä–≥–µ–µ–≤–∏—á",
                        phone: "+7 (999) 111-22-33",
                        email: "info@komplekt-plus.ru",
                        address: "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 15",
                        website: "https://komplekt-plus.ru",
                        partTypes: "–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –ü–ö, –º–∞—Ç—Ä–∏—Ü—ã, –±–ª–æ–∫–∏ –ø–∏—Ç–∞–Ω–∏—è",
                        deliveryDays: 3,
                        minOrder: 10000,
                        rating: 4.5,
                        comments: "–ù–∞–¥–µ–∂–Ω—ã–π –ø–æ—Å—Ç–∞–≤—â–∏–∫, —Ö–æ—Ä–æ—à–∏–µ —Ü–µ–Ω—ã",
                        isActive: true
                    },
                    {
                        id: 2,
                        name: "–¢–î '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞'",
                        contactPerson: "–°–º–∏—Ä–Ω–æ–≤–∞ –û–ª—å–≥–∞ –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞",
                        phone: "+7 (999) 222-33-44",
                        email: "order@td-electron.ru",
                        address: "–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø—Ä. –ù–µ–≤—Å–∫–∏–π, –¥. 45",
                        website: "https://td-electron.ru",
                        partTypes: "SSD, HDD, –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å",
                        deliveryDays: 5,
                        minOrder: 15000,
                        rating: 4.2,
                        comments: "–ë–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä, –±—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞",
                        isActive: true
                    },
                    {
                        id: 3,
                        name: "–û–û–û '–ü—Ä–∏–Ω—Ç–°–µ—Ä–≤–∏—Å'",
                        contactPerson: "–ö—É–∑–Ω–µ—Ü–æ–≤ –ê–ª–µ–∫—Å–µ–π –î–º–∏—Ç—Ä–∏–µ–≤–∏—á",
                        phone: "+7 (999) 333-44-55",
                        email: "sales@printservice.ru",
                        address: "–≥. –ù–∞–ª—å—á–∏–∫, —É–ª. –ö–∏—Ä–æ–≤–∞, –¥. 28",
                        website: "https://printservice.ru",
                        partTypes: "–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏, —Ç–æ–Ω–µ—Ä, —Ñ–æ—Ç–æ–±–∞—Ä–∞–±–∞–Ω—ã",
                        deliveryDays: 2,
                        minOrder: 5000,
                        rating: 4.8,
                        comments: "–õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Å—Ç–∞–≤—â–∏–∫, –≤—Å–µ–≥–¥–∞ –≤ –Ω–∞–ª–∏—á–∏–∏",
                        isActive: true
                    }
                ];
                
                this.saveSuppliers(demoSuppliers);
                return demoSuppliers;
            }
            
            saveServices(services) {
                localStorage.setItem(`${this.storageKey}_services`, JSON.stringify(services));
            }
            
            saveParts(parts) {
                localStorage.setItem(`${this.storageKey}_parts`, JSON.stringify(parts));
            }
            
            saveCategories(categories) {
                localStorage.setItem(`${this.storageKey}_categories`, JSON.stringify(categories));
            }
            
            saveSuppliers(suppliers) {
                localStorage.setItem(`${this.storageKey}_suppliers`, JSON.stringify(suppliers));
            }
            
            // –£—Å–ª—É–≥–∏
            getServices(filter = {}) {
                let filtered = [...this.services];
                
                if (filter.categoryId) {
                    filtered = filtered.filter(s => s.categoryId === filter.categoryId);
                }
                
                if (filter.type) {
                    filtered = filtered.filter(s => s.type === filter.type);
                }
                
                if (filter.search) {
                    const searchTerm = filter.search.toLowerCase();
                    filtered = filtered.filter(s => 
                        s.name.toLowerCase().includes(searchTerm) ||
                        s.description.toLowerCase().includes(searchTerm)
                    );
                }
                
                if (filter.minPrice !== undefined) {
                    filtered = filtered.filter(s => s.price >= filter.minPrice);
                }
                
                if (filter.maxPrice !== undefined) {
                    filtered = filtered.filter(s => s.price <= filter.maxPrice);
                }
                
                if (filter.activeOnly) {
                    filtered = filtered.filter(s => s.isActive);
                }
                
                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
                if (filter.sortBy) {
                    filtered.sort((a, b) => {
                        switch(filter.sortBy) {
                            case 'name_asc':
                                return a.name.localeCompare(b.name);
                            case 'name_desc':
                                return b.name.localeCompare(a.name);
                            case 'price_asc':
                                return a.price - b.price;
                            case 'price_desc':
                                return b.price - a.price;
                            case 'popularity':
                                return b.popularity - a.popularity;
                            default:
                                return 0;
                        }
                    });
                }
                
                return filtered;
            }
            
            addService(serviceData) {
                const newService = {
                    id: this.services.length > 0 ? Math.max(...this.services.map(s => s.id)) + 1 : 1,
                    ...serviceData,
                    popularity: 0,
                    createdAt: new Date().toISOString()
                };
                
                this.services.push(newService);
                this.saveServices(this.services);
                
                return {
                    success: true,
                    service: newService
                };
            }
            
            updateService(serviceId, serviceData) {
                const index = this.services.findIndex(s => s.id === serviceId);
                if (index === -1) {
                    return {
                        success: false,
                        message: '–£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'
                    };
                }
                
                this.services[index] = {
                    ...this.services[index],
                    ...serviceData
                };
                
                this.saveServices(this.services);
                
                return {
                    success: true,
                    service: this.services[index]
                };
            }
            
            deleteService(serviceId) {
                const index = this.services.findIndex(s => s.id === serviceId);
                if (index === -1) {
                    return {
                        success: false,
                        message: '–£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'
                    };
                }
                
                this.services.splice(index, 1);
                this.saveServices(this.services);
                
                return {
                    success: true,
                    message: '–£—Å–ª—É–≥–∞ —É–¥–∞–ª–µ–Ω–∞'
                };
            }
            
            // –ó–∞–ø—á–∞—Å—Ç–∏
            getParts(filter = {}) {
                let filtered = [...this.parts];
                
                if (filter.categoryId) {
                    filtered = filtered.filter(p => p.categoryId === filter.categoryId);
                }
                
                if (filter.supplierId) {
                    filtered = filtered.filter(p => p.supplierId === filter.supplierId);
                }
                
                if (filter.search) {
                    const searchTerm = filter.search.toLowerCase();
                    filtered = filtered.filter(p => 
                        p.name.toLowerCase().includes(searchTerm) ||
                        p.code.toLowerCase().includes(searchTerm) ||
                        p.description.toLowerCase().includes(searchTerm)
                    );
                }
                
                if (filter.minPrice !== undefined) {
                    filtered = filtered.filter(p => p.sellPrice >= filter.minPrice);
                }
                
                if (filter.maxPrice !== undefined) {
                    filtered = filtered.filter(p => p.sellPrice <= filter.maxPrice);
                }
                
                if (filter.stockLevel) {
                    switch(filter.stockLevel) {
                        case 'low':
                            filtered = filtered.filter(p => p.stock <= p.minStock);
                            break;
                        case 'out':
                            filtered = filtered.filter(p => p.stock === 0);
                            break;
                        case 'in':
                            filtered = filtered.filter(p => p.stock > 0);
                            break;
                    }
                }
                
                if (filter.activeOnly) {
                    filtered = filtered.filter(p => p.isActive);
                }
                
                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
                if (filter.sortBy) {
                    filtered.sort((a, b) => {
                        switch(filter.sortBy) {
                            case 'name_asc':
                                return a.name.localeCompare(b.name);
                            case 'name_desc':
                                return b.name.localeCompare(a.name);
                            case 'price_asc':
                                return a.sellPrice - b.sellPrice;
                            case 'price_desc':
                                return b.sellPrice - a.sellPrice;
                            case 'stock':
                                return b.stock - a.stock;
                            case 'popularity':
                                return b.popularity - a.popularity;
                            default:
                                return 0;
                        }
                    });
                }
                
                return filtered;
            }
            
            addPart(partData) {
                const newPart = {
                    id: this.parts.length > 0 ? Math.max(...this.parts.map(p => p.id)) + 1 : 1,
                    ...partData,
                    popularity: 0,
                    lastOrdered: null
                };
                
                this.parts.push(newPart);
                this.saveParts(this.parts);
                
                return {
                    success: true,
                    part: newPart
                };
            }
            
            updatePart(partId, partData) {
                const index = this.parts.findIndex(p => p.id === partId);
                if (index === -1) {
                    return {
                        success: false,
                        message: '–ó–∞–ø—á–∞—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'
                    };
                }
                
                this.parts[index] = {
                    ...this.parts[index],
                    ...partData
                };
                
                this.saveParts(this.parts);
                
                return {
                    success: true,
                    part: this.parts[index]
                };
            }
            
            deletePart(partId) {
                const index = this.parts.findIndex(p => p.id === partId);
                if (index === -1) {
                    return {
                        success: false,
                        message: '–ó–∞–ø—á–∞—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'
                    };
                }
                
                this.parts.splice(index, 1);
                this.saveParts(this.parts);
                
                return {
                    success: true,
                    message: '–ó–∞–ø—á–∞—Å—Ç—å —É–¥–∞–ª–µ–Ω–∞'
                };
            }
            
            updateStock(partId, quantity, operation = 'add') {
                const index = this.parts.findIndex(p => p.id === partId);
                if (index === -1) return false;
                
                if (operation === 'add') {
                    this.parts[index].stock += quantity;
                } else if (operation === 'subtract') {
                    this.parts[index].stock = Math.max(0, this.parts[index].stock - quantity);
                } else if (operation === 'set') {
                    this.parts[index].stock = quantity;
                }
                
                this.saveParts(this.parts);
                return true;
            }
            
            getLowStockParts() {
                return this.parts.filter(p => p.stock <= p.minStock && p.stock > 0);
            }
            
            getOutOfStockParts() {
                return this.parts.filter(p => p.stock === 0);
            }
            
            // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
            getCategories(type = null) {
                let filtered = [...this.categories];
                
                if (type) {
                    if (type === 'both') {
                        filtered = filtered.filter(c => c.type === 'service' || c.type === 'both');
                    } else {
                        filtered = filtered.filter(c => c.type === type || c.type === 'both');
                    }
                }
                
                return filtered;
            }
            
            addCategory(categoryData) {
                const newCategory = {
                    id: this.categories.length > 0 ? Math.max(...this.categories.map(c => c.id)) + 1 : 1,
                    ...categoryData
                };
                
                this.categories.push(newCategory);
                this.saveCategories(this.categories);
                
                return {
                    success: true,
                    category: newCategory
                };
            }
            
            // –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏
            getSuppliers() {
                return this.suppliers.filter(s => s.isActive);
            }
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            getCatalogStats() {
                const totalServices = this.services.length;
                const totalParts = this.parts.length;
                const activeServices = this.services.filter(s => s.isActive).length;
                const activeParts = this.parts.filter(p => p.isActive).length;
                
                const totalStockValue = this.parts.reduce((sum, part) => 
                    sum + (part.stock * part.costPrice), 0);
                
                const lowStockCount = this.getLowStockParts().length;
                const outOfStockCount = this.getOutOfStockParts().length;
                
                return {
                    totalServices,
                    totalParts,
                    activeServices,
                    activeParts,
                    totalStockValue,
                    lowStockCount,
                    outOfStockCount,
                    categoriesCount: this.categories.length,
                    suppliersCount: this.suppliers.length
                };
            }
        }
        
        // –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–∏—Å—Ç–µ–º—ã
        window.Services = new ServicesSystem();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            initServicesPage();
        });
        
        function initServicesPage() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–∞–±–∞–º
            const tabs = document.querySelectorAll('.service-tab');
            const contents = document.querySelectorAll('.services-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // –£–¥–∞–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Ç–∞–±–æ–≤ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                    tabs.forEach(t => t.classList.remove('active'));
                    contents.forEach(c => c.classList.remove('active'));
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–º—É —Ç–∞–±—É –∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É
                    this.classList.add('active');
                    const content = document.getElementById(`${tabId}Tab`);
                    if (content) {
                        content.classList.add('active');
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–∞–±–∞
                        loadTabData(tabId);
                    }
                });
            });
            
            // –ö–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
            document.getElementById('addServiceBtn')?.addEventListener('click', function() {
                openModal('addServiceModal');
                loadServiceForm();
            });
            
            document.getElementById('addPartBtn')?.addEventListener('click', function() {
                openModal('addPartModal');
                loadPartForm();
            });
            
            document.getElementById('addCategoryBtn')?.addEventListener('click', function() {
                openModal('addCategoryModal');
                loadCategoryForm();
            });
            
            document.getElementById('addSupplierBtn')?.addEventListener('click', function() {
                openModal('addSupplierModal');
                loadSupplierForm();
            });
            
            document.getElementById('addFirstServiceBtn')?.addEventListener('click', function() {
                openModal('addServiceModal');
                loadServiceForm();
            });
            
            document.getElementById('addFirstPartBtn')?.addEventListener('click', function() {
                openModal('addPartModal');
                loadPartForm();
            });
            
            // –ü–æ–∏—Å–∫
            const searchInput = document.getElementById('servicesSearch');
            if (searchInput) {
                searchInput.addEventListener('input', debounce(performSearch, 300));
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
            const sortSelect = document.getElementById('sortBy');
            if (sortSelect) {
                sortSelect.addEventListener('change', function() {
                    applyFilters();
                });
            }
            
            // –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
            document.getElementById('resetFiltersBtn')?.addEventListener('click', resetFilters);
            
            // –ó–∞–∫–∞–∑ –∑–∞–ø—á–∞—Å—Ç–µ–π
            document.getElementById('orderStockBtn')?.addEventListener('click', orderLowStock);
            
            // –ü–µ—á–∞—Ç—å –∏ —ç–∫—Å–ø–æ—Ä—Ç –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞
            document.getElementById('printPriceListBtn')?.addEventListener('click', printPriceList);
            document.getElementById('exportPriceListBtn')?.addEventListener('click', exportPriceList);
            
            // –§–æ—Ä–º—ã
            document.getElementById('addServiceForm')?.addEventListener('submit', handleAddService);
            document.getElementById('addPartForm')?.addEventListener('submit', handleAddPart);
            document.getElementById('addCategoryForm')?.addEventListener('submit', handleAddCategory);
            document.getElementById('addSupplierForm')?.addEventListener('submit', handleAddSupplier);
            
            // –†–∞—Å—á–µ—Ç –Ω–∞—Ü–µ–Ω–∫–∏ –¥–ª—è –∑–∞–ø—á–∞—Å—Ç–µ–π
            setupMarginCalculation();
            
            // –†–µ–π—Ç–∏–Ω–≥ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
            setupSupplierRating();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            loadInitialData();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤
            updateCounters();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∑–∫–∏—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤
            checkLowStock();
        }
        
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        function loadInitialData() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            loadCategoryFilters();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–∞–±–∞
            const activeTab = document.querySelector('.service-tab.active');
            if (activeTab) {
                const tabId = activeTab.getAttribute('data-tab');
                loadTabData(tabId);
            }
        }
        
        function loadCategoryFilters() {
            const container = document.getElementById('categoriesFilter');
            if (!container) return;
            
            const categories = Services.getCategories();
            
            const allCategories = [
                { id: 'all', name: '–í—Å–µ', type: 'both', count: Services.getCatalogStats().totalServices + Services.getCatalogStats().totalParts }
            ];
            
            const serviceCategories = categories.filter(c => c.type === 'service' || c.type === 'both');
            const partCategories = categories.filter(c => c.type === 'part' || c.type === 'both');
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
            const stats = Services.getCatalogStats();
            
            container.innerHTML = `
                ${allCategories.map(cat => `
                    <button class="category-btn active" data-category="${cat.id}" data-type="all">
                        ${cat.name}
                        <span class="badge badge-primary ml-1">${cat.count}</span>
                    </button>
                `).join('')}
                
                ${serviceCategories.map(cat => {
                    const count = Services.getServices({ categoryId: cat.id }).length;
                    return `
                        <button class="category-btn" data-category="${cat.id}" data-type="service">
                            ${cat.name}
                            <span class="badge badge-info ml-1">${count}</span>
                        </button>
                    `;
                }).join('')}
                
                ${partCategories.map(cat => {
                    const count = Services.getParts({ categoryId: cat.id }).length;
                    return `
                        <button class="category-btn" data-category="${cat.id}" data-type="part">
                            ${cat.name}
                            <span class="badge badge-warning ml-1">${count}</span>
                        </button>
                    `;
                }).join('')}
            `;
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            container.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // –£–¥–∞–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                    container.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
                    this.classList.add('active');
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
                    applyFilters();
                });
            });
        }
        
        function loadTabData(tabId) {
            switch(tabId) {
                case 'services':
                    loadServicesGrid();
                    break;
                case 'parts':
                    loadPartsGrid();
                    break;
                case 'categories':
                    loadCategoriesTable();
                    break;
                case 'suppliers':
                    loadSuppliersTable();
                    break;
                case 'priceList':
                    loadPriceListTable();
                    break;
            }
        }
        
        function loadServicesGrid() {
            const grid = document.getElementById('servicesGrid');
            const emptyState = document.getElementById('emptyServices');
            if (!grid || !emptyState) return;
            
            const filters = getCurrentFilters();
            filters.activeOnly = true;
            
            const services = Services.getServices(filters);
            
            if (services.length === 0) {
                grid.innerHTML = '';
                emptyState.classList.remove('d-none');
                return;
            }
            
            emptyState.classList.add('d-none');
            
            grid.innerHTML = services.map(service => `
                <div class="service-card" data-service-id="${service.id}">
                    <div class="service-card-header">
                        <div>
                            <div class="service-card-category">
                                <span class="badge badge-primary">${service.categoryName}</span>
                                <span class="ml-2 text-muted">${getServiceTypeName(service.type)}</span>
                            </div>
                            <h3 class="service-card-title">${service.name}</h3>
                        </div>
                        <div class="service-actions">
                            <button class="action-btn edit" data-service-id="${service.id}" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" data-service-id="${service.id}" title="–£–¥–∞–ª–∏—Ç—å">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="service-icon ${service.type}">
                        <i class="fas ${getServiceIcon(service.type)}"></i>
                    </div>
                    
                    <p class="service-card-description">${service.description}</p>
                    
                    <div class="service-card-price">
                        ${service.price.toLocaleString('ru-RU')} ‚ÇΩ
                    </div>
                    
                    <div class="service-card-footer">
                        <div>
                            <div class="text-muted small">
                                <i class="far fa-clock mr-1"></i>
                                ${service.duration} —á
                            </div>
                            <div class="text-muted small">
                                <i class="fas fa-shield-alt mr-1"></i>
                                –ì–∞—Ä–∞–Ω—Ç–∏—è: ${service.warranty} –º–µ—Å
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-muted small mb-1">
                                <i class="fas fa-chart-line mr-1"></i>
                                –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å: ${service.popularity}
                            </div>
                            <button class="btn btn-sm btn-primary" data-service-id="${service.id}" data-action="use">
                                –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
            grid.querySelectorAll('.action-btn.edit').forEach(btn => {
                btn.addEventListener('click', function() {
                    const serviceId = parseInt(this.getAttribute('data-service-id'));
                    editService(serviceId);
                });
            });
            
            grid.querySelectorAll('.action-btn.delete').forEach(btn => {
                btn.addEventListener('click', function() {
                    const serviceId = parseInt(this.getAttribute('data-service-id'));
                    deleteService(serviceId);
                });
            });
            
            grid.querySelectorAll('button[data-action="use"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const serviceId = parseInt(this.getAttribute('data-service-id'));
                    useService(serviceId);
                });
            });
        }
        
        function loadPartsGrid() {
            const grid = document.getElementById('partsGrid');
            const emptyState = document.getElementById('emptyParts');
            if (!grid || !emptyState) return;
            
            const filters = getCurrentFilters();
            filters.activeOnly = true;
            
            const parts = Services.getParts(filters);
            
            if (parts.length === 0) {
                grid.innerHTML = '';
                emptyState.classList.remove('d-none');
                return;
            }
            
            emptyState.classList.add('d-none');
            
            grid.innerHTML = parts.map(part => {
                const margin = ((part.sellPrice - part.costPrice) / part.costPrice * 100).toFixed(1);
                const stockStatus = getStockStatus(part.stock, part.minStock);
                
                return `
                <div class="service-card" data-part-id="${part.id}">
                    <div class="service-card-header">
                        <div>
                            <div class="service-card-category">
                                <span class="badge badge-warning">${part.categoryName}</span>
                                ${part.warranty > 0 ? `<span class="warranty-badge">${part.warranty} –º–µ—Å</span>` : ''}
                            </div>
                            <h3 class="service-card-title">${part.name}</h3>
                            <div class="supplier-info">
                                <i class="fas fa-truck mr-1"></i>
                                ${part.supplierName || '–ü–æ—Å—Ç–∞–≤—â–∏–∫ –Ω–µ —É–∫–∞–∑–∞–Ω'}
                            </div>
                        </div>
                        <div class="service-actions">
                            <button class="action-btn edit" data-part-id="${part.id}" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" data-part-id="${part.id}" title="–£–¥–∞–ª–∏—Ç—å">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="service-icon parts">
                        <i class="fas fa-microchip"></i>
                    </div>
                    
                    <p class="service-card-description">
                        ${part.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}
                        ${part.code ? `<div class="text-muted small mt                        <div class="mt-2">
                            <span class="badge badge-light">–ê—Ä—Ç–∏–∫—É–ª: ${part.code}</span>
                        </div>` : ''}
                    </p>
                    
                    <div class="service-card-price">
                        ${part.sellPrice.toLocaleString('ru-RU')} ‚ÇΩ
                        <div class="price-history">
                            <small>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å: ${part.costPrice.toLocaleString('ru-RU')} ‚ÇΩ</small>
                            <div class="price-change ${margin >= 0 ? 'up' : 'down'}">
                                <i class="fas ${margin >= 0 ? 'fa-arrow-up' : 'fa-arrow-down'} mr-1"></i>
                                ${margin}%
                            </div>
                        </div>
                    </div>
                    
                    <div class="service-card-footer">
                        <div class="service-card-stock">
                            <span class="stock-badge ${stockStatus.class}">${stockStatus.text}</span>
                            <span class="ml-2">${part.stock} —à—Ç</span>
                            <small class="text-muted ml-2">(–º–∏–Ω: ${part.minStock})</small>
                        </div>
                        <div class="text-right">
                            <div class="text-muted small mb-1">
                                <i class="fas fa-chart-line mr-1"></i>
                                –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å: ${part.popularity}
                            </div>
                            <div>
                                <button class="btn btn-sm btn-secondary mr-1" data-part-id="${part.id}" data-action="adjust-stock">
                                    <i class="fas fa-boxes"></i>
                                </button>
                                <button class="btn btn-sm btn-primary" data-part-id="${part.id}" data-action="use">
                                    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `}).join('');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
            grid.querySelectorAll('.action-btn.edit').forEach(btn => {
                btn.addEventListener('click', function() {
                    const partId = parseInt(this.getAttribute('data-part-id'));
                    editPart(partId);
                });
            });
            
            grid.querySelectorAll('.action-btn.delete').forEach(btn => {
                btn.addEventListener('click', function() {
                    const partId = parseInt(this.getAttribute('data-part-id'));
                    deletePart(partId);
                });
            });
            
            grid.querySelectorAll('button[data-action="adjust-stock"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const partId = parseInt(this.getAttribute('data-part-id'));
                    adjustStock(partId);
                });
            });
            
            grid.querySelectorAll('button[data-action="use"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const partId = parseInt(this.getAttribute('data-part-id'));
                    usePart(partId);
                });
            });
        }
        
        function loadCategoriesTable() {
            const tbody = document.getElementById('categoriesTableBody');
            if (!tbody) return;
            
            const categories = Services.getCategories();
            const stats = Services.getCatalogStats();
            
            tbody.innerHTML = categories.map(category => {
                const serviceCount = Services.getServices({ categoryId: category.id }).length;
                const partCount = Services.getParts({ categoryId: category.id }).length;
                const totalCount = serviceCount + partCount;
                
                let typeBadge;
                switch(category.type) {
                    case 'service':
                        typeBadge = '<span class="badge badge-primary">–£—Å–ª—É–≥–∏</span>';
                        break;
                    case 'part':
                        typeBadge = '<span class="badge badge-warning">–ó–∞–ø—á–∞—Å—Ç–∏</span>';
                        break;
                    case 'both':
                        typeBadge = '<span class="badge badge-success">–û–±–∞ —Ç–∏–ø–∞</span>';
                        break;
                }
                
                return `
                <tr data-category-id="${category.id}">
                    <td>
                        <div class="d-flex align-items-center">
                            <div class="mr-2" style="color: ${category.color || '#6B7280'}; font-size: 20px;">
                                ${getCategoryIcon(category.icon)}
                            </div>
                            <div>
                                <div class="font-weight-medium">${category.name}</div>
                                <div class="text-muted small">${category.description || ''}</div>
                            </div>
                        </div>
                    </td>
                    <td>${typeBadge}</td>
                    <td>
                        <div class="text-center">
                            <div class="mb-1">
                                <span class="badge badge-primary mr-1">${serviceCount}</span>
                                <span class="badge badge-warning">${partCount}</span>
                            </div>
                            <small class="text-muted">–í—Å–µ–≥–æ: ${totalCount}</small>
                        </div>
                    </td>
                    <td>
                        <div class="text-muted small">${category.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
                    </td>
                    <td>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-secondary" data-action="edit-category" data-category-id="${category.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger" data-action="delete-category" data-category-id="${category.id}"
                                    ${totalCount > 0 ? 'disabled title="–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å: –µ—Å—Ç—å —É—Å–ª—É–≥–∏/–∑–∞–ø—á–∞—Å—Ç–∏"' : ''}>
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `}).join('');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
            tbody.querySelectorAll('[data-action="edit-category"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const categoryId = parseInt(this.getAttribute('data-category-id'));
                    editCategory(categoryId);
                });
            });
            
            tbody.querySelectorAll('[data-action="delete-category"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const categoryId = parseInt(this.getAttribute('data-category-id'));
                    deleteCategory(categoryId);
                });
            });
        }
        
        function loadSuppliersTable() {
            const tbody = document.getElementById('suppliersTableBody');
            if (!tbody) return;
            
            const suppliers = Services.getSuppliers();
            
            tbody.innerHTML = suppliers.map(supplier => {
                const ratingStars = getRatingStars(supplier.rating);
                
                return `
                <tr data-supplier-id="${supplier.id}">
                    <td>
                        <div class="font-weight-medium">${supplier.name}</div>
                        <div class="text-muted small">${supplier.contactPerson || '–ö–æ–Ω—Ç–∞–∫—Ç –Ω–µ —É–∫–∞–∑–∞–Ω'}</div>
                    </td>
                    <td>
                        <div>${supplier.phone || '‚Äî'}</div>
                        <div class="text-muted small">${supplier.email || '‚Äî'}</div>
                    </td>
                    <td>
                        <div class="text-muted small">${supplier.partTypes || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</div>
                    </td>
                    <td>
                        <div class="text-center">
                            <span class="badge ${supplier.deliveryDays <= 3 ? 'badge-success' : supplier.deliveryDays <= 7 ? 'badge-warning' : 'badge-danger'}">
                                ${supplier.deliveryDays} –¥–Ω
                            </span>
                        </div>
                    </td>
                    <td>
                        <div class="d-flex align-items-center">
                            <div class="mr-2">${ratingStars}</div>
                            <div class="text-muted small">${supplier.rating.toFixed(1)}</div>
                        </div>
                    </td>
                    <td>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-secondary" data-action="edit-supplier" data-supplier-id="${supplier.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger" data-action="delete-supplier" data-supplier-id="${supplier.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `}).join('');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
            tbody.querySelectorAll('[data-action="edit-supplier"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const supplierId = parseInt(this.getAttribute('data-supplier-id'));
                    editSupplier(supplierId);
                });
            });
            
            tbody.querySelectorAll('[data-action="delete-supplier"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const supplierId = parseInt(this.getAttribute('data-supplier-id'));
                    deleteSupplier(supplierId);
                });
            });
        }
        
        function loadPriceListTable() {
            const tbody = document.getElementById('priceListTableBody');
            if (!tbody) return;
            
            const services = Services.getServices({ activeOnly: true });
            const parts = Services.getParts({ activeOnly: true });
            
            // –û–±—ä–µ–¥–∏–Ω—è–µ–º —É—Å–ª—É–≥–∏ –∏ –∑–∞–ø—á–∞—Å—Ç–∏
            const items = [
                ...services.map(service => ({
                    id: service.id,
                    name: service.name,
                    type: 'service',
                    typeText: '–£—Å–ª—É–≥–∞',
                    category: service.categoryName,
                    code: '-',
                    cost: '-',
                    price: service.price,
                    margin: '-',
                    stock: '-'
                })),
                ...parts.map(part => {
                    const margin = ((part.sellPrice - part.costPrice) / part.costPrice * 100).toFixed(1);
                    const stockStatus = getStockStatus(part.stock, part.minStock);
                    
                    return {
                        id: part.id,
                        name: part.name,
                        type: 'part',
                        typeText: '–ó–∞–ø—á–∞—Å—Ç—å',
                        category: part.categoryName,
                        code: part.code || '-',
                        cost: part.costPrice,
                        price: part.sellPrice,
                        margin: `${margin}%`,
                        stock: `${part.stock} —à—Ç (${stockStatus.text})`
                    };
                })
            ];
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Ç–∏–ø—É –∏ –Ω–∞–∑–≤–∞–Ω–∏—é
            items.sort((a, b) => {
                if (a.type !== b.type) return a.type === 'service' ? -1 : 1;
                return a.name.localeCompare(b.name);
            });
            
            tbody.innerHTML = items.map(item => `
                <tr data-item-id="${item.id}" data-item-type="${item.type}">
                    <td>
                        <div class="font-weight-medium">${item.name}</div>
                        ${item.code !== '-' ? `<div class="text-muted small">–ö–æ–¥: ${item.code}</div>` : ''}
                    </td>
                    <td>
                        <span class="badge ${item.type === 'service' ? 'badge-primary' : 'badge-warning'}">
                            ${item.typeText}
                        </span>
                    </td>
                    <td>${item.category}</td>
                    <td>${item.code}</td>
                    <td>${item.cost === '-' ? '-' : `${item.cost.toLocaleString('ru-RU')} ‚ÇΩ`}</td>
                    <td class="font-weight-bold">${item.price.toLocaleString('ru-RU')} ‚ÇΩ</td>
                    <td>
                        <span class="${item.margin !== '-' && parseFloat(item.margin) >= 30 ? 'text-success font-weight-medium' : ''}">
                            ${item.margin}
                        </span>
                    </td>
                    <td>${item.stock}</td>
                </tr>
            `).join('');
        }
        
        function loadServiceForm() {
            const form = document.getElementById('addServiceForm');
            if (!form) return;
            
            const categorySelect = form.querySelector('[name="categoryId"]');
            if (categorySelect) {
                const categories = Services.getCategories('service');
                categorySelect.innerHTML = `
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                    ${categories.map(cat => `
                        <option value="${cat.id}">${cat.name}</option>
                    `).join('')}
                `;
            }
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            form.reset();
        }
        
        function loadPartForm() {
            const form = document.getElementById('addPartForm');
            if (!form) return;
            
            const categorySelect = form.querySelector('[name="categoryId"]');
            const supplierSelect = form.querySelector('[name="supplierId"]');
            
            if (categorySelect) {
                const categories = Services.getCategories('part');
                categorySelect.innerHTML = `
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                    ${categories.map(cat => `
                        <option value="${cat.id}">${cat.name}</option>
                    `).join('')}
                `;
            }
            
            if (supplierSelect) {
                const suppliers = Services.getSuppliers();
                supplierSelect.innerHTML = `
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</option>
                    ${suppliers.map(sup => `
                        <option value="${sup.id}">${sup.name}</option>
                    `).join('')}
                `;
            }
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            form.reset();
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä–∂–∏
            setupFormMarginCalculation(form);
        }
        
        function loadCategoryForm() {
            const form = document.getElementById('addCategoryForm');
            if (!form) return;
            
            const parentSelect = form.querySelector('[name="parentId"]');
            const iconSelect = form.querySelector('[name="icon"]');
            const iconPreview = document.getElementById('iconPreview');
            
            if (parentSelect) {
                const categories = Services.getCategories();
                parentSelect.innerHTML = `
                    <option value="">–ù–µ—Ç (–∫–æ—Ä–Ω–µ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è)</option>
                    ${categories.map(cat => `
                        <option value="${cat.id}">${cat.name}</option>
                    `).join('')}
                `;
            }
            
            if (iconSelect && iconPreview) {
                iconSelect.addEventListener('change', function() {
                    const iconValue = this.value;
                    iconPreview.textContent = getIconSymbol(iconValue);
                });
            }
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            form.reset();
        }
        
        function loadSupplierForm() {
            const form = document.getElementById('addSupplierForm');
            if (!form) return;
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            form.reset();
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            const ratingInput = form.querySelector('[name="rating"]');
            const ratingValue = document.getElementById('ratingValue');
            if (ratingInput && ratingValue) {
                ratingInput.value = '3';
                ratingValue.textContent = '3/5';
            }
        }
        
        function setupMarginCalculation() {
            const form = document.getElementById('addPartForm');
            if (form) {
                setupFormMarginCalculation(form);
            }
        }
        
        function setupFormMarginCalculation(form) {
            const costInput = form.querySelector('[name="costPrice"]');
            const priceInput = form.querySelector('[name="sellPrice"]');
            const marginInput = form.querySelector('[name="margin"]');
            
            function calculateMargin() {
                const cost = parseFloat(costInput.value) || 0;
                const price = parseFloat(priceInput.value) || 0;
                
                if (cost > 0) {
                    const margin = ((price - cost) / cost * 100).toFixed(1);
                    marginInput.value = `${margin}%`;
                } else {
                    marginInput.value = '‚Äî';
                }
            }
            
            if (costInput && priceInput && marginInput) {
                costInput.addEventListener('input', calculateMargin);
                priceInput.addEventListener('input', calculateMargin);
            }
        }
        
        function setupSupplierRating() {
            const form = document.getElementById('addSupplierForm');
            if (!form) return;
            
            const stars = form.querySelectorAll('.rating-stars i');
            const ratingInput = form.querySelector('[name="rating"]');
            const ratingValue = document.getElementById('ratingValue');
            
            stars.forEach(star => {
                star.addEventListener('mouseenter', function() {
                    const rating = parseInt(this.getAttribute('data-rating'));
                    highlightStars(rating);
                });
                
                star.addEventListener('click', function() {
                    const rating = parseInt(this.getAttribute('data-rating'));
                    if (ratingInput) ratingInput.value = rating;
                    if (ratingValue) ratingValue.textContent = `${rating}/5`;
                });
            });
            
            form.querySelector('.rating-stars').addEventListener('mouseleave', function() {
                const currentRating = ratingInput ? parseInt(ratingInput.value) : 3;
                highlightStars(currentRating);
            });
            
            function highlightStars(count) {
                stars.forEach((star, index) => {
                    if (index < count) {
                        star.classList.remove('far');
                        star.classList.add('fas');
                        star.style.color = '#F59E0B';
                    } else {
                        star.classList.remove('fas');
                        star.classList.add('far');
                        star.style.color = '#D1D5DB';
                    }
                });
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            highlightStars(ratingInput ? parseInt(ratingInput.value) : 3);
        }
        
        function getCurrentFilters() {
            const filters = {};
            
            // –¢–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
            const activeCategoryBtn = document.querySelector('.category-filter .category-btn.active');
            if (activeCategoryBtn) {
                const categoryId = activeCategoryBtn.getAttribute('data-category');
                const categoryType = activeCategoryBtn.getAttribute('data-type');
                
                if (categoryId && categoryId !== 'all') {
                    filters.categoryId = parseInt(categoryId);
                }
            }
            
            // –ü–æ–∏—Å–∫
            const searchInput = document.getElementById('servicesSearch');
            if (searchInput && searchInput.value.trim()) {
                filters.search = searchInput.value.trim();
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
            const sortSelect = document.getElementById('sortBy');
            if (sortSelect) {
                filters.sortBy = sortSelect.value;
            }
            
            // –ê–∫—Ç–∏–≤–Ω—ã–π —Ç–∞–±
            const activeTab = document.querySelector('.service-tab.active');
            if (activeTab) {
                filters.tab = activeTab.getAttribute('data-tab');
            }
            
            return filters;
        }
        
        function performSearch() {
            applyFilters();
        }
        
        function applyFilters() {
            const activeTab = document.querySelector('.service-tab.active');
            if (!activeTab) return;
            
            const tabId = activeTab.getAttribute('data-tab');
            
            switch(tabId) {
                case 'services':
                    loadServicesGrid();
                    break;
                case 'parts':
                    loadPartsGrid();
                    break;
                case 'categories':
                    loadCategoriesTable();
                    break;
                case 'suppliers':
                    loadSuppliersTable();
                    break;
                case 'priceList':
                    loadPriceListTable();
                    break;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
            updateCounters();
        }
        
        function resetFilters() {
            // –°–±—Ä–æ—Å –ø–æ–∏—Å–∫–∞
            const searchInput = document.getElementById('servicesSearch');
            if (searchInput) searchInput.value = '';
            
            // –°–±—Ä–æ—Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
            const sortSelect = document.getElementById('sortBy');
            if (sortSelect) sortSelect.value = 'name_asc';
            
            // –°–±—Ä–æ—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            const categoryFilter = document.getElementById('categoriesFilter');
            if (categoryFilter) {
                const allBtn = categoryFilter.querySelector('[data-category="all"]');
                if (allBtn) {
                    categoryFilter.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
                    allBtn.classList.add('active');
                }
            }
            
            applyFilters();
        }
        
        function handleAddService(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const serviceData = {
                name: formData.get('name'),
                categoryId: parseInt(formData.get('categoryId')),
                type: formData.get('type'),
                description: formData.get('description'),
                price: parseFloat(formData.get('price')),
                duration: parseFloat(formData.get('duration')),
                warranty: parseInt(formData.get('warranty')),
                isActive: formData.get('isActive') === 'on'
            };
            
            const result = Services.addService(serviceData);
            
            if (result.success) {
                showNotification('–£—Å–ª—É–≥–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                closeModal('addServiceModal');
                applyFilters();
                updateCounters();
            } else {
                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —É—Å–ª—É–≥–∏', 'error');
            }
        }
        
        function handleAddPart(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const supplierId = formData.get('supplierId');
            
            const partData = {
                name: formData.get('name'),
                code: formData.get('code'),
                categoryId: parseInt(formData.get('categoryId')),
                description: formData.get('description'),
                costPrice: parseFloat(formData.get('costPrice')),
                sellPrice: parseFloat(formData.get('sellPrice')),
                stock: parseInt(formData.get('stock')),
                minStock: parseInt(formData.get('minStock')),
                supplierId: supplierId ? parseInt(supplierId) : null,
                warranty: parseInt(formData.get('warranty')),
                isActive: formData.get('isActive') === 'on'
            };
            
            const result = Services.addPart(partData);
            
            if (result.success) {
                showNotification('–ó–∞–ø—á–∞—Å—Ç—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                closeModal('addPartModal');
                applyFilters();
                updateCounters();
                checkLowStock();
            } else {
                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–ø—á–∞—Å—Ç–∏', 'error');
            }
        }
        
        function handleAddCategory(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const parentId = formData.get('parentId');
            
            const categoryData = {
                name: formData.get('name'),
                type: formData.get('type'),
                description: formData.get('description'),
                parentId: parentId ? parseInt(parentId) : null,
                color: formData.get('color'),
                icon: formData.get('icon')
            };
            
            const result = Services.addCategory(categoryData);
            
            if (result.success) {
                showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                closeModal('addCategoryModal');
                loadCategoryFilters();
                applyFilters();
                updateCounters();
            } else {
                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏', 'error');
            }
        }
        
        function handleAddSupplier(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const supplierData = {
                name: formData.get('name'),
                contactPerson: formData.get('contactPerson'),
                phone: formData.get('phone'),
                email: formData.get('email'),
                address: formData.get('address'),
                website: formData.get('website'),
                partTypes: formData.get('partTypes'),
                deliveryDays: parseInt(formData.get('deliveryDays')),
                minOrder: parseFloat(formData.get('minOrder')),
                rating: parseFloat(formData.get('rating')),
                comments: formData.get('comments'),
                isActive: true
            };
            
            Services.saveSuppliers([...Services.suppliers, {
                id: Services.suppliers.length > 0 ? Math.max(...Services.suppliers.map(s => s.id)) + 1 : 1,
                ...supplierData
            }]);
            
            showNotification('–ü–æ—Å—Ç–∞–≤—â–∏–∫ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
            closeModal('addSupplierModal');
            loadTabData('suppliers');
            updateCounters();
        }
        
        function editService(serviceId) {
            const service = Services.services.find(s => s.id === serviceId);
            if (!service) return;
            
            openModal('addServiceModal');
            
            const form = document.getElementById('addServiceForm');
            if (form) {
                form.querySelector('[name="name"]').value = service.name;
                form.querySelector('[name="categoryId"]').value = service.categoryId;
                form.querySelector('[name="type"]').value = service.type;
                form.querySelector('[name="description"]').value = service.description || '';
                form.querySelector('[name="price"]').value = service.price;
                form.querySelector('[name="duration"]').value = service.duration;
                form.querySelector('[name="warranty"]').value = service.warranty;
                form.querySelector('[name="isActive"]').checked = service.isActive;
                
                // –ò–∑–º–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –¥–µ–π—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º—ã
                const modalTitle = document.querySelector('#addServiceModal .modal-title');
                if (modalTitle) modalTitle.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏';
                
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π
                form.removeEventListener('submit', handleAddService);
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const formData = new FormData(form);
                    
                    const updatedData = {
                        name: formData.get('name'),
                        categoryId: parseInt(formData.get('categoryId')),
                        type: formData.get('type'),
                        description: formData.get('description'),
                        price: parseFloat(formData.get('price')),
                        duration: parseFloat(formData.get('duration')),
                        warranty: parseInt(formData.get('warranty')),
                        isActive: formData.get('isActive') === 'on'
                    };
                    
                    const result = Services.updateService(serviceId, updatedData);
                    
                    if (result.success) {
                        showNotification('–£—Å–ª—É–≥–∞ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
                        closeModal('addServiceModal');
                        applyFilters();
                    } else {
                        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —É—Å–ª—É–≥–∏', 'error');
                    }
                });
            }
        }
        
        function editPart(partId) {
            const part = Services.parts.find(p => p.id === partId);
            if (!part) return;
            
            openModal('addPartModal');
            
            const form = document.getElementById('addPartForm');
            if (form) {
                form.querySelector('[name="name"]').value = part.name;
                form.querySelector('[name="code"]').value = part.code || '';
                form.querySelector('[name="categoryId"]').value = part.categoryId;
                form.querySelector('[name="description"]').value = part.description || '';
                form.querySelector('[name="costPrice"]').value = part.costPrice;
                form.querySelector('[name="sellPrice"]').value = part.sellPrice;
                form.querySelector('[name="stock"]').value = part.stock;
                form.querySelector('[name="minStock"]').value = part.minStock;
                form.querySelector('[name="supplierId"]').value = part.supplierId || '';
                form.querySelector('[name="warranty"]').value = part.warranty;
                form.querySelector('[name="isActive"]').checked = part.isActive;
                
                // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–∞—Ä–∂—É
                if (part.costPrice > 0) {
                    const margin = ((part.sellPrice - part.costPrice) / part.costPrice * 100).toFixed(1);
                    form.querySelector('[name="margin"]').value = `${margin}%`;
                }
                
                // –ò–∑–º–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –¥–µ–π—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º—ã
                const modalTitle = document.querySelector('#addPartModal .modal-title');
                if (modalTitle) modalTitle.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏';
                
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏
                loadPartForm();
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ
                form.querySelector('[name="supplierId"]').value = part.supplierId || '';
                
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π
                form.removeEventListener('submit', handleAddPart);
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const formData = new FormData(form);
                    
                    const supplierId = formData.get('supplierId');
                    
                    const updatedData = {
                        name: formData.get('name'),
                        code: formData.get('code'),
                        categoryId: parseInt(formData.get('categoryId')),
                        description: formData.get('description'),
                        costPrice: parseFloat(formData.get('costPrice')),
                        sellPrice: parseFloat(formData.get('sellPrice')),
                        stock: parseInt(formData.get('stock')),
                        minStock: parseInt(formData.get('minStock')),
                        supplierId: supplierId ? parseInt(supplierId) : null,
                        warranty: parseInt(formData.get('warranty')),
                        isActive: formData.get('isActive') === 'on'
                    };
                    
                    const result = Services.updatePart(partId, updatedData);
                    
                    if (result.success) {
                        showNotification('–ó–∞–ø—á–∞—Å—Ç—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
                        closeModal('addPartModal');
                        applyFilters();
                        checkLowStock();
                    } else {
                        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–ø—á–∞—Å—Ç–∏', 'error');
                    }
                });
            }
        }
        
        function editCategory(categoryId) {
            const category = Services.categories.find(c => c.id === categoryId);
            if (!category) return;
            
            openModal('addCategoryModal');
            
            const form = document.getElementById('addCategoryForm');
            if (form) {
                form.querySelector('[name="name"]').value = category.name;
                form.querySelector('[name="type"]').value = category.type;
                form.querySelector('[name="description"]').value = category.description || '';
                form.querySelector('[name="parentId"]').value = category.parentId || '';
                form.querySelector('[name="color"]').value = category.color || '#1E40AF';
                form.querySelector('[name="icon"]').value = category.icon || 'tools';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–≤—å—é –∏–∫–æ–Ω–∫–∏
                const iconPreview = document.getElementById('iconPreview');
                if (iconPreview) {
                    iconPreview.textContent = getIconSymbol(category.icon || 'tools');
                }
                
                // –ò–∑–º–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –¥–µ–π—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º—ã
                const modalTitle = document.querySelector('#addCategoryModal .modal-title');
                if (modalTitle) modalTitle.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏';
                
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π
                form.removeEventListener('submit', handleAddCategory);
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const formData = new FormData(form);
                    
                    const parentId = formData.get('parentId');
                    
                    const updatedData = {
                        name: formData.get('name'),
                        type: formData.get('type'),
                        description: formData.get('description'),
                        parentId: parentId ? parseInt(parentId) : null,
                        color: formData.get('color'),
                        icon: formData.get('icon')
                    };
                    
                    const index = Services.categories.findIndex(c => c.id === categoryId);
                    if (index !== -1) {
                        Services.categories[index] = {
                            ...Services.categories[index],
                            ...updatedData
                        };
                        
                        Services.saveCategories(Services.categories);
                        
                        showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
                        closeModal('addCategoryModal');
                        loadCategoryFilters();
                        applyFilters();
                        updateCounters();
                    } else {
                        showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    }
                });
            }
        }
        
        function editSupplier(supplierId) {
            const supplier = Services.suppliers.find(s => s.id === supplierId);
            if (!supplier) return;
            
            openModal('addSupplierModal');
            
            const form = document.getElementById('addSupplierForm');
            if (form) {
                form.querySelector('[name="name"]').value = supplier.name;
                form.querySelector('[name="contactPerson"]').value = supplier.contactPerson || '';
                form.querySelector('[name="phone"]').value = supplier.phone || '';
                form.querySelector('[name="email"]').value = supplier.email || '';
                form.querySelector('[name="address"]').value = supplier.address || '';
                form.querySelector('[name="website"]').value = supplier.website || '';
                form.querySelector('[name="partTypes"]').value = supplier.partTypes || '';
                form.querySelector('[name="deliveryDays"]').value = supplier.deliveryDays;
                form.querySelector('[name="minOrder"]').value = supplier.minOrder;
                form.querySelector('[name="comments"]').value = supplier.comments || '';
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥
                form.querySelector('[name="rating"]').value = supplier.rating;
                const ratingValue = document.getElementById('ratingValue');
                if (ratingValue) {
                    ratingValue.textContent = `${supplier.rating.toFixed(1)}/5`;
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–≤–µ–∑–¥—ã
                setupSupplierRating();
                
                // –ò–∑–º–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –¥–µ–π—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º—ã
                const modalTitle = document.querySelector('#addSupplierModal .modal-title');
                if (modalTitle) modalTitle.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞';
                
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π
                form.removeEventListener('submit', handleAddSupplier);
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const formData = new FormData(form);
                    
                    const updatedData = {
                        name: formData.get('name'),
                        contactPerson: formData.get('contactPerson'),
                        phone: formData.get('phone'),
                        email: formData.get('email'),
                        address: formData.get('address'),
                        website: formData.get('website'),
                        partTypes: formData.get('partTypes'),
                        deliveryDays: parseInt(formData.get('deliveryDays')),
                        minOrder: parseFloat(formData.get('minOrder')),
                        rating: parseFloat(formData.get('rating')),
                        comments: formData.get('comments'),
                        isActive: true
                    };
                    
                    const index = Services.suppliers.findIndex(s => s.id === supplierId);
                    if (index !== -1) {
                        Services.suppliers[index] = {
                            ...Services.suppliers[index],
                            ...updatedData
                        };
                        
                        Services.saveSuppliers(Services.suppliers);
                        
                        showNotification('–ü–æ—Å—Ç–∞–≤—â–∏–∫ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!', 'success');
                        closeModal('addSupplierModal');
                        loadTabData('suppliers');
                        updateCounters();
                    } else {
                        showNotification('–ü–æ—Å—Ç–∞–≤—â–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    }
                });
            }
        }
        
        function deleteService(serviceId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —É—Å–ª—É–≥—É?')) {
                const result = Services.deleteService(serviceId);
                
                if (result.success) {
                    showNotification('–£—Å–ª—É–≥–∞ —É–¥–∞–ª–µ–Ω–∞', 'success');
                    applyFilters();
                    updateCounters();
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —É—Å–ª—É–≥–∏', 'error');
                }
            }
        }
        
        function deletePart(partId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø—á–∞—Å—Ç—å?')) {
                const result = Services.deletePart(partId);
                
                if (result.success) {
                    showNotification('–ó–∞–ø—á–∞—Å—Ç—å —É–¥–∞–ª–µ–Ω–∞', 'success');
                    applyFilters();
                    updateCounters();
                    checkLowStock();
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–ø—á–∞—Å—Ç–∏', 'error');
                }
            }
        }
        
        function deleteCategory(categoryId) {
            const serviceCount = Services.getServices({ categoryId }).length;
            const partCount = Services.getParts({ categoryId }).length;
            
            if (serviceCount > 0 || partCount > 0) {
                alert(`–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é, —Ç–∞–∫ –∫–∞–∫ –≤ –Ω–µ–π –µ—Å—Ç—å ${serviceCount} —É—Å–ª—É–≥ –∏ ${partCount} –∑–∞–ø—á–∞—Å—Ç–µ–π.`);
                return;
            }
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é?')) {
                const index = Services.categories.findIndex(c => c.id === categoryId);
                
                if (index !== -1) {
                    Services.categories.splice(index, 1);
                    Services.saveCategories(Services.categories);
                    
                    showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞', 'success');
                    loadCategoryFilters();
                    applyFilters();
                    updateCounters();
                } else {
                    showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                }
            }
        }
        
        function deleteSupplier(supplierId) {
            const partsCount = Services.getParts({ supplierId }).length;
            
            if (partsCount > 0) {
                alert(`–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞, —Ç–∞–∫ –∫–∞–∫ –µ—Å—Ç—å ${partsCount} –∑–∞–ø—á–∞—Å—Ç–µ–π –æ—Ç —ç—Ç–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞.`);
                return;
            }
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞?')) {
                const index = Services.suppliers.findIndex(s => s.id === supplierId);
                
                if (index !== -1) {
                    // –í–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è –¥–µ–ª–∞–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º
                    Services.suppliers[index].isActive = false;
                    Services.saveSuppliers(Services.suppliers);
                    
                    showNotification('–ü–æ—Å—Ç–∞–≤—â–∏–∫ –æ—Ç–∫–ª—é—á–µ–Ω', 'success');
                    loadTabData('suppliers');
                    updateCounters();
                } else {
                    showNotification('–ü–æ—Å—Ç–∞–≤—â–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                }
            }
        }
        
        function adjustStock(partId) {
            const part = Services.parts.find(p => p.id === partId);
            if (!part) return;
            
            const newStock = prompt(`–¢–µ–∫—É—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫: ${part.stock} —à—Ç\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:`, part.stock);
            
            if (newStock !== null) {
                const quantity = parseInt(newStock);
                
                if (!isNaN(quantity) && quantity >= 0) {
                    Services.updateStock(partId, quantity, 'set');
                    showNotification('–û—Å—Ç–∞—Ç–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
                    applyFilters();
                    checkLowStock();
                } else {
                    showNotification('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ', 'error');
                }
            }
        }
        
        function useService(serviceId) {
            if (confirm('–î–æ–±–∞–≤–∏—Ç—å —ç—Ç—É —É—Å–ª—É–≥—É –∫ —Ç–µ–∫—É—â–µ–π –∑–∞—è–≤–∫–µ?')) {
                // –ó–¥–µ—Å—å –æ–±—ã—á–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥—É –∫ –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞—è–≤–∫–µ
                // –í –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Å—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å
                const service = Services.services.find(s => s.id === serviceId);
                if (service) {
                    service.popularity = (service.popularity || 0) + 1;
                    Services.saveServices(Services.services);
                    showNotification('–£—Å–ª—É–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫ –∑–∞—è–≤–∫–µ', 'success');
                }
            }
        }
        
        function usePart(partId) {
            const part = Services.parts.find(p => p.id === partId);
            if (!part) return;
            
            const quantity = prompt(`–¢–µ–∫—É—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫: ${part.stock} —à—Ç\n–°–∫–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—Ü –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?`, '1');
            
            if (quantity !== null) {
                const qty = parseInt(quantity);
                
                if (!isNaN(qty) && qty > 0 && qty <= part.stock) {
                    Services.updateStock(partId, qty, 'subtract');
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å
                    part.popularity = (part.popularity || 0) + 1;
                    Services.saveParts(Services.parts);
                    
                    showNotification(`–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ ${qty} —à—Ç`, 'success');
                    applyFilters();
                    checkLowStock();
                } else if (qty > part.stock) {
                    showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞ —Å–∫–ª–∞–¥–µ', 'error');
                } else {
                    showNotification('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ', 'error');
                }
            }
        }
        
        function updateCounters() {
            const stats = Services.getCatalogStats();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –≤ —Ç–∞–±–∞—Ö
            const servicesCount = document.getElementById('servicesCount');
            const partsCount = document.getElementById('partsCount');
            const categoriesCount = document.getElementById('categoriesCount');
            const suppliersCount = document.getElementById('suppliersCount');
            
            if (servicesCount) servicesCount.textContent = stats.totalServices;
            if (partsCount) partsCount.textContent = stats.totalParts;
            if (categoriesCount) categoriesCount.textContent = stats.categoriesCount;
            if (suppliersCount) suppliersCount.textContent = stats.suppliersCount;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            loadCategoryFilters();
        }
        
        function checkLowStock() {
            const lowStockAlert = document.getElementById('lowStockAlert');
            const lowStockItems = document.getElementById('lowStockItems');
            
            if (!lowStockAlert || !lowStockItems) return;
            
            const lowStockParts = Services.getLowStockParts();
            const outOfStockParts = Services.getOutOfStockParts();
            
            if (lowStockParts.length > 0 || outOfStockParts.length > 0) {
                lowStockAlert.classList.remove('d-none');
                
                let itemsText = '';
                
                if (outOfStockParts.length > 0) {
                    itemsText += `<strong>–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏:</strong> ${outOfStockParts.map(p => p.name).join(', ')}<br>`;
                }
                
                if (lowStockParts.length > 0) {
                    itemsText += `<strong>–ù–∏–∑–∫–∏–π –∑–∞–ø–∞—Å:</strong> ${lowStockParts.map(p => `${p.name} (${p.stock} —à—Ç)`).join(', ')}`;
                }
                
                lowStockItems.innerHTML = itemsText;
            } else {
                lowStockAlert.classList.add('d-none');
            }
        }
        
        function orderLowStock() {
            const lowStockParts = Services.getLowStockParts();
            const outOfStockParts = Services.getOutOfStockParts();
            
            if (lowStockParts.length === 0 && outOfStockParts.length === 0) {
                showNotification('–ù–µ—Ç –∑–∞–ø—á–∞—Å—Ç–µ–π –¥–ª—è –∑–∞–∫–∞–∑–∞', 'info');
                return;
            }
            
            let orderMessage = '–ó–∞–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏:\n\n';
            
            if (outOfStockParts.length > 0) {
                orderMessage += '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏:\n';
                outOfStockParts.forEach(part => {
                    const suggestedQty = part.minStock * 2;
                    orderMessage += `‚Ä¢ ${part.name} (${suggestedQty} —à—Ç)\n`;
                });
                orderMessage += '\n';
            }
            
            if (lowStockParts.length > 0) {
                orderMessage += '–ù–∏–∑–∫–∏–π –∑–∞–ø–∞—Å:\n';
                lowStockParts.forEach(part => {
                    const suggestedQty = part.minStock * 2 - part.stock;
                    orderMessage += `‚Ä¢ ${part.name} (${suggestedQty} —à—Ç)\n`;
                });
            }
            
            if (confirm(orderMessage + '\n–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑?')) {
                showNotification('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º', 'success');
                // –ó–¥–µ—Å—å –æ–±—ã—á–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–∞–∑ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º
            }
        }
        
        function printPriceList() {
            const originalTitle = document.title;
            document.title = '–ü—Ä–∞–π—Å-–ª–∏—Å—Ç —É—Å–ª—É–≥ –∏ –∑–∞–ø—á–∞—Å—Ç–µ–π - ' + new Date().toLocaleDateString();
            
            window.print();
            
            document.title = originalTitle;
        }
        
        function exportPriceList() {
            const services = Services.getServices({ activeOnly: true });
            const parts = Services.getParts({ activeOnly: true });
            
            let csvContent = "data:text/csv;charset=utf-8,";
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫
            csvContent += "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ,–¢–∏–ø,–ö–∞—Ç–µ–≥–æ—Ä–∏—è,–ö–æ–¥,–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å,–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏,–ù–∞—Ü–µ–Ω–∫–∞,–û—Å—Ç–∞—Ç–æ–∫\n";
            
            // –£—Å–ª—É–≥–∏
            services.forEach(service => {
                csvContent += `${service.name},–£—Å–ª—É–≥–∞,${service.categoryName},-,${service.price},${service.price},-,-\n`;
            });
            
            // –ó–∞–ø—á–∞—Å—Ç–∏
            parts.forEach(part => {
                const margin = ((part.sellPrice - part.costPrice) / part.costPrice * 100).toFixed(1);
                csvContent += `${part.name},–ó–∞–ø—á–∞—Å—Ç—å,${part.categoryName},${part.code || '-'},${part.costPrice},${part.sellPrice},${margin}%,${part.stock}\n`;
            });
            
            // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `price-list-${new Date().toISOString().slice(0,10)}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('–ü—Ä–∞–π—Å-–ª–∏—Å—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω', 'success');
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getServiceTypeName(type) {
            const types = {
                'diagnostic': '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞',
                'repair': '–†–µ–º–æ–Ω—Ç',
                'software': '–ü–û',
                'cleaning': '–ß–∏—Å—Ç–∫–∞',
                'preventive': '–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞',
                'other': '–î—Ä—É–≥–æ–µ'
            };
            return types[type] || type;
        }
        
        function getServiceIcon(type) {
            const icons = {
                'diagnostic': 'fa-search',
                'repair': 'fa-wrench',
                'software': 'fa-desktop',
                'cleaning': 'fa-broom',
                'preventive': 'fa-shield-alt',
                'other': 'fa-cogs'
            };
            return icons[type] || 'fa-cogs';
        }
        
        function getStockStatus(stock, minStock) {
            if (stock === 0) {
                return { class: 'stock-out', text: '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏' };
            } else if (stock <= minStock * 0.3) {
                return { class: 'stock-low', text: '–û—á–µ–Ω—å –º–∞–ª–æ' };
            } else if (stock <= minStock) {
                return { class: 'stock-medium', text: '–ú–∞–ª–æ' };
            } else {
                return { class: 'stock-high', text: '–í –Ω–∞–ª–∏—á–∏–∏' };
            }
        }
        
        function getCategoryIcon(icon) {
            const icons = {
                'tools': 'üõ†Ô∏è',
                'microchip': 'üíª',
                'desktop': 'üñ•Ô∏è',
                'laptop': 'üíª',
                'printer': 'üñ®Ô∏è',
                'mobile': 'üì±',
                'cog': '‚öôÔ∏è',
                'wrench': 'üîß',
                'search': 'üîç'
            };
            return icons[icon] || 'üìÅ';
        }
        
        function getIconSymbol(icon) {
            return getCategoryIcon(icon);
        }
        
        function getRatingStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            
            for (let i = 1; i <= 5; i++) {
                if (i <= fullStars) {
                    stars += '<i class="fas fa-star" style="color: #F59E0B;"></i>';
                } else if (i === fullStars + 1 && hasHalfStar) {
                    stars += '<i class="fas fa-star-half-alt" style="color: #F59E0B;"></i>';
                } else {
                    stars += '<i class="far fa-star" style="color: #D1D5DB;"></i>';
                }
            }
            
            return stars;
        }
        
        function showNotification(message, type = 'info') {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é
            alert(message); // –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
        }
        
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'block';
                setTimeout(() => modal.classList.add('show'), 10);
            }
        }
        
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('show');
                setTimeout(() => modal.style.display = 'none', 300);
            }
        }
    </script>
</body>
</html>